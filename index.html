<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Calendario de Adviento</title>

  <style>
    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      padding: 0;
      height: 100vh;
      overflow: hidden;
      background: black;
      font-family: Arial;
    }

    /* CONTENEDOR - AHORA CON EL GIF DE ENTRADA COMO FONDO */
    #contenedor-gif {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background-color: #000000;
      display: flex;
      justify-content: center;
      align-items: center;

      /* SOLUCI√ìN AL PARPADEO: El GIF siempre visible detr√°s */
      background-image: url("assets/gif.gif"); 
      background-size: contain; 
      background-repeat: no-repeat;
      background-position: center;
    }

    /* Este ID ahora se usar√° solo para los elementos de video, ya no para el GIF */
    #gif-principal {
      width: 105%;
      height: 100%;
      object-fit: contain;
      object-position: center;
    }

    /* ESTILO DEL CUADRO DE TEXTO (ACT√öA COMO BOT√ìN) */
    #texto {
      position: fixed;
      top: 20px;
      left: 50%;
      transform: translateX(-50%);
      width: 85vw;
      padding: 12px;
      background: white;
      border: 3px solid red;
      border-radius: 12px;
      box-shadow: 0px 4px 12px rgba(0,0,0,0.4);
      font-size: 20px;
      font-weight: bold;
      text-align: center;
      z-index: 10;
      cursor: pointer; 
      transition: transform 0.1s;
    }
    
    #texto:active {
        transform: translateX(-50%) scale(0.98);
    }
  </style>
</head>
<body>

  <audio id="voz-personaje" src="assets/copitosi.mp3"></audio>

  <div id="texto"></div>

  <div id="contenedor-gif">
    <img id="gif-principal" src="">
  </div>

  <script>

    const gifEntrada = "assets/gif.gif";       // Se usa como fondo CSS
    const videoPrimerClick = "assets/gif2.mp4"; 
    const videoRepetido = "assets/gif3.mp4";   

    const mensajeInicial = "Da clic aqu√≠ para descubrir tu sorpresa de hoy";
    const mensajeRepetido = "Es uno por d√≠a suato, vuelve ma√±ana.";

    const mensajesPorDia = [
        "",
        "Feliz navidad!!", //1
        "Abre el regalo n√∫mero 3", //2 paletas payaso
        "Abre el regalo n√∫mero 20", //3
        "Abre el regalo n√∫mero 17", //4
        "Abre el regalo n√∫mero 6", //5 perfume
        "Abre el regalo n√∫mero 23", //6 cancion gravedad
        "Abre el regalo n√∫mero 1", //7 teni 1
        "Abre el regalo n√∫mero 9", //8 teni 2
        "Abre el regalo n√∫mero 12", //9
        "Abre el regalo n√∫mero 25", //10
        "Abre el regalo n√∫mero 8", //11
        "Abre el regalo n√∫mero 19", //12
        "Abre el regalo n√∫mero 11", //13 libro 31 minutos 
        "Abre el regalo n√∫mero 2", //14
        "Abre el regalo n√∫mero 15", //15
        "Abre el regalo n√∫mero 7", //16
        "Abre el regalo n√∫mero 22", //17
        "Abre el regalo n√∫mero 16", //18
        "Abre el regalo n√∫mero 18", //19 playera waltmart
        "Abre el regalo n√∫mero 4", //20
        "Abre el regalo n√∫mero 10", //21
        "Abre el regalo n√∫mero 5", //22
        "Abre el regalo n√∫mero 13", //23
        "Abre el regalo n√∫mero 24", //24
        "Feliz aniversariooo, abre el regalo n√∫mero 21", //25 Dibujo
        "Ya no hay regalos, invitame unos bongles!!",
        "¬øQu√© haces aqu√≠?",
        "Eres el mejor!!",
        "¬øQue haces aqu√≠?",
        "Comprame pollo",
        "Feliz a√±o nuevoooo!!"
    ];

    /* ---------- AUDIO 3 VECES + TEXTO LENTO ---------- */
    function escribirTextoLento(texto, velocidad = 40) {
      const cuadro = document.getElementById("texto");
      cuadro.textContent = "";

      const voz = document.getElementById("voz-personaje");

      // üîä Reproducir 3 veces seguidas
      let repeticiones = 0;
      voz.currentTime = 0;
      voz.play().catch(()=>{});

      voz.onended = function () {
        repeticiones++;
        if (repeticiones < 3) {
          voz.currentTime = 0;
          voz.play();
        }
      };

      // ‚å®Ô∏è Animaci√≥n de escritura
      let i = 0;
      const intervalo = setInterval(() => {
        cuadro.textContent += texto[i];
        i++;

        if (i >= texto.length) {
          clearInterval(intervalo);
        }
      }, velocidad);
    }

    /* ---------- ESTADO INICIAL ---------- */
    const contenedorGif = document.getElementById("contenedor-gif");
    escribirTextoLento(mensajeInicial);

    const hoy = new Date().toDateString();

    /* ---------- CAMBIAR A VIDEO ---------- */
    function reproducirVideo(rutaVideo) {
      contenedorGif.innerHTML = ''; 

      const video = document.createElement("video");
      video.src = rutaVideo;
      video.autoplay = true;
      video.muted = true;
      video.playsinline = true;
      video.loop = false;
      video.id = "gif-principal"; 
      video.style.width = "105%";
      video.style.height = "100%";
      video.style.objectFit = "contain";
      video.style.objectPosition = "center";

      contenedorGif.appendChild(video);
    }

    /* ---------- EVENTO CLIC EN EL CUADRO DE TEXTO ---------- */
    document.getElementById("texto").addEventListener("click", () => {

      const ultimoDia = localStorage.getItem("clickHoy");

      // Si NO ha clickeado hoy
      if (ultimoDia !== hoy) {
        localStorage.setItem("clickHoy", hoy);

        reproducirVideo(videoPrimerClick);

        const dia = new Date().getDate();
        escribirTextoLento(mensajesPorDia[dia]); 
        return;
      }

      // Si YA clicke√≥ hoy
      reproducirVideo(videoRepetido);
      escribirTextoLento(mensajeRepetido);
    });

  </script>

</body>
</html>
